
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec  # for unequal plot boxes
from scipy.optimize import curve_fit


r1 = [4.0052304, 5.1758242, 6.2525535, 7.1661859, 8.0759382, 9.8332319, 12.47436, 16.912725, 23.565262, 29.88183, 36.394661, 41.377602, 45.845562, 49.339577, 52.262768, 55.999477, 60.298962, 64.199486, 67.394424, 70.819633, 74.083878, 77.485901, 81.616043, 84.564438, 88.96891, 93.27597, 97.997925, 104.2205, 117.01855, 140.69923]
y1 = [0.00015197088763160076, 0.00012620565028128021, 9.6589429504711209e-05, 8.1594932632447038e-05, 6.0221394209633007e-05, 2.4978476661777036e-05, 9.9221885666300492e-06, 3.422830068403985e-06, 1.1964697320709113e-06, 6.9864426322620525e-07, 4.5671002183567099e-07, 4.5568445878401405e-07, 4.1749815476912926e-07, 3.9541405437756976e-07, 4.4873671724980355e-07, 3.0848327335889589e-07, 2.7210355799781894e-07, 2.363504185190354e-07, 2.4140830578528576e-07, 2.1354861023684703e-07, 1.9976681363594837e-07, 1.66713746048324e-07, 1.341946293011552e-07, 1.6026549486902029e-07, 1.0618604150720272e-07, 9.4951020140576203e-08, 7.4567497911863577e-08, 4.8682250016040388e-08, 2.059845189074865e-08, 6.8007677000744574e-09]


r = np.asarray(r1)
y = np.asarray(y1)
e = (0.3*y)

plt.loglog(r1, y, '.')
plt.show()


    #return ne*((r)/(rx))**a * (1 + (r)/(rx))**-(3.0*b/2.0) + neo*(1.0 + (r)/(rxx))**-(3.0*bb/2.0)

def line(r, a, b):
    return a * r  ** b 
    
popt, pcov = curve_fit(line, r, y, sigma = e, p0=[70.0,0.5])

print "a =", popt[0], "+/-", pcov[0,0]**0.5
print "b =", popt[1], "+/-", pcov[1,1]**0.5


plt.errorbar(r, y, yerr=e, fmt= "none")
rfine = np.linspace(5, 150., 150)  # define values to plot the function for
plt.loglog(rfine, line(rfine, popt[0], popt[1]), 'r-')


plt.show()